type UserProxy @entity {
  id: ID!
  proxyAddress: Bytes!
  userAddress: Bytes!
}

enum PositionTransactionType {
  MODIFY
  TRANSFER
  CONFISCATE
}

type PositionTransaction @entity {
  id: ID!
  type: String!
  collateral: BigInt!
  deltaCollateral: BigInt!
  normalDebt: BigInt!
  deltaNormalDebt: BigInt!
  position: Position!
}

type Position @entity {
  id: ID!
  vault: Vault
  collateral: Collateral
  userPosition: UserPosition!
  totalCollateral: BigInt!
  totalNormalDebt: BigInt!
  maturity: BigInt
  positionTransactions: [PositionTransaction!] @derivedFrom(field: "position")
}

enum VaultType {
  ELEMENT,
  BARNBRIDGE,
  NOTIONAL
}

type Vault @entity {
  id: ID!
  address: Bytes
  name: String
  type: VaultType
  positions: [Position!] @derivedFrom(field: "vault")
  collaterals: [Collateral!] @derivedFrom(field: "vault")
}

type Collateral @entity {
  id: ID!
  address: Bytes
  symbol: String
  maturity: BigInt
  underlierSymbol: String
  underlierAddress: Bytes
  vault: Vault
  faceValue: BigInt
  collaterizationRatio: BigInt
  depositedCollateral: BigInt
}

type UserPosition @entity {
  id: ID!
  proxyAddress: Bytes
  totalCollateral: BigInt
  totalFIAT: BigInt
  nearestMaturity: BigInt
  positions: [Position!] @derivedFrom(field: "userPosition")
}

type FiatData @entity {
  id: ID!
  address: Bytes
  minted: BigInt
  burned: BigInt
  totalSupply: BigInt
}
